{"version":3,"file":"pbrBlockSheen.js","sourceRoot":"","sources":["../../../../../../lts/core/generated/Shaders/ShadersInclude/pbrBlockSheen.ts"],"names":[],"mappings":"AAAA,eAAe;AACf,OAAO,EAAE,WAAW,EAAE,MAAM,2BAA2B,CAAC;AAExD,IAAM,IAAI,GAAG,eAAe,CAAC;AAC7B,IAAM,MAAM,GAAG,8gKA8Ld,CAAC;AACF,aAAa;AACb,WAAW,CAAC,oBAAoB,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;AAChD,cAAc;AACd,MAAM,CAAC,IAAM,aAAa,GAAG,EAAE,IAAI,MAAA,EAAE,MAAM,QAAA,EAAE,CAAC","sourcesContent":["// Do not edit.\nimport { ShaderStore } from \"../../Engines/shaderStore\";\n\nconst name = \"pbrBlockSheen\";\nconst shader = `#ifdef SHEEN\nstruct sheenOutParams\r{\rfloat sheenIntensity;\rvec3 sheenColor;\rfloat sheenRoughness;\r#ifdef SHEEN_LINKWITHALBEDO\nvec3 surfaceAlbedo;\r#endif\n#if defined(ENVIRONMENTBRDF) && defined(SHEEN_ALBEDOSCALING)\nfloat sheenAlbedoScaling;\r#endif\n#if defined(REFLECTION) && defined(ENVIRONMENTBRDF)\nvec3 finalSheenRadianceScaled;\r#endif\n#if DEBUGMODE>0\nvec4 sheenMapData;\rvec3 sheenEnvironmentReflectance;\r#endif\n};\r#define pbr_inline\n#define inline\nvoid sheenBlock(\rin vec4 vSheenColor,\r#ifdef SHEEN_ROUGHNESS\nin float vSheenRoughness,\r#if defined(SHEEN_TEXTURE_ROUGHNESS) && !defined(SHEEN_TEXTURE_ROUGHNESS_IDENTICAL) && !defined(SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE)\nin vec4 sheenMapRoughnessData,\r#endif\n#endif\nin float roughness,\r#ifdef SHEEN_TEXTURE\nin vec4 sheenMapData,\rin float sheenMapLevel,\r#endif\nin float reflectance,\r#ifdef SHEEN_LINKWITHALBEDO\nin vec3 baseColor,\rin vec3 surfaceAlbedo,\r#endif\n#ifdef ENVIRONMENTBRDF\nin float NdotV,\rin vec3 environmentBrdf,\r#endif\n#if defined(REFLECTION) && defined(ENVIRONMENTBRDF)\nin vec2 AARoughnessFactors,\rin vec3 vReflectionMicrosurfaceInfos,\rin vec2 vReflectionInfos,\rin vec3 vReflectionColor,\rin vec4 vLightingIntensity,\r#ifdef REFLECTIONMAP_3D\nin samplerCube reflectionSampler,\rin vec3 reflectionCoords,\r#else\nin sampler2D reflectionSampler,\rin vec2 reflectionCoords,\r#endif\nin float NdotVUnclamped,\r#ifndef LODBASEDMICROSFURACE\n#ifdef REFLECTIONMAP_3D\nin samplerCube reflectionSamplerLow,\rin samplerCube reflectionSamplerHigh,\r#else\nin sampler2D reflectionSamplerLow,\rin sampler2D reflectionSamplerHigh,\r#endif\n#endif\n#ifdef REALTIME_FILTERING\nin vec2 vReflectionFilteringInfo,\r#endif\n#if !defined(REFLECTIONMAP_SKYBOX) && defined(RADIANCEOCCLUSION)\nin float seo,\r#endif\n#if !defined(REFLECTIONMAP_SKYBOX) && defined(HORIZONOCCLUSION) && defined(BUMP) && defined(REFLECTIONMAP_3D)\nin float eho,\r#endif\n#endif\nout sheenOutParams outParams\r)\r{\rfloat sheenIntensity=vSheenColor.a;\r#ifdef SHEEN_TEXTURE\n#if DEBUGMODE>0\noutParams.sheenMapData=sheenMapData;\r#endif\n#endif\n#ifdef SHEEN_LINKWITHALBEDO\nfloat sheenFactor=pow5(1.0-sheenIntensity);\rvec3 sheenColor=baseColor.rgb*(1.0-sheenFactor);\rfloat sheenRoughness=sheenIntensity;\routParams.surfaceAlbedo=surfaceAlbedo*sheenFactor;\r#ifdef SHEEN_TEXTURE\nsheenIntensity*=sheenMapData.a;\r#endif\n#else\nvec3 sheenColor=vSheenColor.rgb;\r#ifdef SHEEN_TEXTURE\n#ifdef SHEEN_GAMMATEXTURE\nsheenColor.rgb*=toLinearSpace(sheenMapData.rgb);\r#else\nsheenColor.rgb*=sheenMapData.rgb;\r#endif\nsheenColor.rgb*=sheenMapLevel;\r#endif\n#ifdef SHEEN_ROUGHNESS\nfloat sheenRoughness=vSheenRoughness;\r#ifdef SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE\n#if defined(SHEEN_TEXTURE)\nsheenRoughness*=sheenMapData.a;\r#endif\n#elif defined(SHEEN_TEXTURE_ROUGHNESS)\n#ifdef SHEEN_TEXTURE_ROUGHNESS_IDENTICAL\nsheenRoughness*=sheenMapData.a;\r#else\nsheenRoughness*=sheenMapRoughnessData.a;\r#endif\n#endif\n#else\nfloat sheenRoughness=roughness;\r#ifdef SHEEN_TEXTURE\nsheenIntensity*=sheenMapData.a;\r#endif\n#endif\n#if !defined(SHEEN_ALBEDOSCALING)\nsheenIntensity*=(1.-reflectance);\r#endif\nsheenColor*=sheenIntensity;\r#endif\n#ifdef ENVIRONMENTBRDF\n/*#ifdef SHEEN_SOFTER\rvec3 environmentSheenBrdf=vec3(0.,0.,getBRDFLookupCharlieSheen(NdotV,sheenRoughness));\r#else*/\n#ifdef SHEEN_ROUGHNESS\nvec3 environmentSheenBrdf=getBRDFLookup(NdotV,sheenRoughness);\r#else\nvec3 environmentSheenBrdf=environmentBrdf;\r#endif\n/*#endif*/\r#endif\n#if defined(REFLECTION) && defined(ENVIRONMENTBRDF)\nfloat sheenAlphaG=convertRoughnessToAverageSlope(sheenRoughness);\r#ifdef SPECULARAA\nsheenAlphaG+=AARoughnessFactors.y;\r#endif\nvec4 environmentSheenRadiance=vec4(0.,0.,0.,0.);\rsampleReflectionTexture(\rsheenAlphaG,\rvReflectionMicrosurfaceInfos,\rvReflectionInfos,\rvReflectionColor,\r#if defined(LODINREFLECTIONALPHA) && !defined(REFLECTIONMAP_SKYBOX)\nNdotVUnclamped,\r#endif\n#ifdef LINEARSPECULARREFLECTION\nsheenRoughness,\r#endif\nreflectionSampler,\rreflectionCoords,\r#ifndef LODBASEDMICROSFURACE\nreflectionSamplerLow,\rreflectionSamplerHigh,\r#endif\n#ifdef REALTIME_FILTERING\nvReflectionFilteringInfo,\r#endif\nenvironmentSheenRadiance\r);\rvec3 sheenEnvironmentReflectance=getSheenReflectanceFromBRDFLookup(sheenColor,environmentSheenBrdf);\r#if !defined(REFLECTIONMAP_SKYBOX) && defined(RADIANCEOCCLUSION)\nsheenEnvironmentReflectance*=seo;\r#endif\n#if !defined(REFLECTIONMAP_SKYBOX) && defined(HORIZONOCCLUSION) && defined(BUMP) && defined(REFLECTIONMAP_3D)\nsheenEnvironmentReflectance*=eho;\r#endif\n#if DEBUGMODE>0\noutParams.sheenEnvironmentReflectance=sheenEnvironmentReflectance;\r#endif\noutParams.finalSheenRadianceScaled=\renvironmentSheenRadiance.rgb *\rsheenEnvironmentReflectance *\rvLightingIntensity.z;\r#endif\n#if defined(ENVIRONMENTBRDF) && defined(SHEEN_ALBEDOSCALING)\noutParams.sheenAlbedoScaling=1.0-sheenIntensity*max(max(sheenColor.r,sheenColor.g),sheenColor.b)*environmentSheenBrdf.b;\r#endif\noutParams.sheenIntensity=sheenIntensity;\routParams.sheenColor=sheenColor;\routParams.sheenRoughness=sheenRoughness;\r}\r#endif\n`;\n// Sideeffect\nShaderStore.IncludesShadersStore[name] = shader;\n/** @hidden */\nexport const pbrBlockSheen = { name, shader };\n"]}